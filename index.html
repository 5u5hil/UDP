<!Doctype html>
<html>
    <head>
        <title>UDP</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="pure-min.css" rel="stylesheet" type="text/css"/>
        <script src="jquery.min.js"></script>
        <script src="phonegap.js"></script>
        <script>
            var key = "";

            $(document).ready(function () {

                networkinterface.getIPAddress(function (ip) {
                    $("#myip").text(ip);
                });

                $("#connect").click(function () {
                    window.tlantic.plugins.socket.connect(onConnect, stub, $("#ip").val(), $("#port").val());
                });

                $("#send").click(function () {
                    window.tlantic.plugins.socket.send(stub, stub, key, $("#msg").val());
                });
            });



            function stub(d) {
                alert(JSON.stringify(d));
            }

            function onConnect(k) {
                alert('Established connection with ', k);
                key = k;
            }


            document.addEventListener(window.tlantic.plugins.socket.receiveHookName, function (ev) {
                $("#log").append("<li>" + ev.metadata.data + "</li>");

            });
        </script>
    </head>
    <body>

        <form class="pure-form pure-form-aligned">
            <fieldset>
                <div class="pure-control-group">
                    <label for="name">IP</label>
                    <input id="ip" name="ip" type="text" value="192.168.1." placeholder="IP">
                </div>

                <div class="pure-control-group">
                    <label for="name">Port</label>
                    <input id="port" name="port" type="number" value="7000" placeholder="Port">
                </div>

                <div class="pure-controls">
                    <button type="button" class="pure-button pure-button-primary" id="connect">Connect</button>
                </div>
            </fieldset>
        </form>

        <form class="pure-form pure-form-aligned">
            <fieldset>
                <div class="pure-control-group">
                    <label for="name">Send Message</label>
                    <input id="msg" name="msg" type="text" value="Hello World!" placeholder="Message">
                </div>

                <div class="pure-controls">
                    <button type="button" class="pure-button pure-button-primary" id="send">Send</button>
                </div>
            </fieldset>
        </form>

        <p>To Subscribe use this IP : <strong id="myip"></strong></p>

        <ul id="log">
            <li><strong>Received Messages</strong></li>
        </ul>
    </body>
</html>